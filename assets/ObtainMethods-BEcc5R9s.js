import{g as z,_ as X}from"./services-data-DdhGTTRJ.js";import{r as D,j as e,u as bt}from"./react-vendor-DmEpS5Kz.js";import{g as yt,D as d}from"./extractsService-g3Pje2Ba.js";import{t as Ee,a as wt,b as Dt,c as be,d as Le,e as We,f as St,g as At,h as Xe,i as Et}from"./data-tw-other-De0qaQHL.js";import{t as $}from"./data-tw-items-4ChDDRSh.js";import{m as Ze,f as $e,a as ie,q as Te,l as ye,b as Lt,i as Je,p as $t}from"./data-other-BAzrwk9S.js";import{f as Y}from"./data-db-CylQINsK.js";import{I as Q}from"./index-DjjYDhw0.js";import"./opencc-C1Qz6KEM.js";import"./data-tw-descriptions-CJIEoqIq.js";import"./vendor-dPMYpV4t.js";import"./axios-B9ygI19o.js";function Ke(N,p=100,U=0){return(N-1)*p/40.96+U}function Tt({isOpen:N,onClose:p,zoneName:U,x:H,y,npcName:k,mapId:Z}){const[we,J]=D.useState(!0),[q,O]=D.useState(null),[se,ae]=D.useState(100),[pe,ue]=D.useState(0),[le,ce]=D.useState(0);if(D.useEffect(()=>{if(!N){O(null),J(!0);return}O(null),J(!0);const _=setTimeout(()=>{if(Z&&Ze[Z]){const K=Ze[Z];O(K.image),ae(K.size_factor||100),ue(K.offset_x||0),ce(K.offset_y||0),J(!1)}else O(null),J(!1)},50);return()=>clearTimeout(_)},[N,Z]),D.useEffect(()=>{const _=K=>{K.key==="Escape"&&p()};return N&&(document.addEventListener("keydown",_),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",_),document.body.style.overflow=""}},[N,p]),!N)return null;const B=Ke(H,se,pe),De=Ke(y,se,le);return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70",onClick:p,children:e.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700 max-w-lg w-full max-h-[90vh] overflow-hidden",onClick:_=>_.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-700",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-white",children:U}),k&&e.jsx("p",{className:"text-sm text-gray-400",children:k})]}),e.jsx("button",{onClick:p,className:"p-1 rounded hover:bg-slate-700 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"relative aspect-square bg-slate-900",children:we?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-purple-400 border-t-purple-600"})}):q?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:q,alt:U,className:"w-full h-full object-contain",onError:_=>{_.target.style.display="none"}},`${Z}-${H}-${y}`),e.jsx("div",{className:"absolute pointer-events-none",style:{left:`${B}%`,top:`${De}%`,width:"24px",height:"24px",transform:"translate(-50%, -100%)",zIndex:10},children:e.jsx("svg",{className:"w-full h-full text-red-500 drop-shadow-lg",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 0C7.58 0 4 3.58 4 8c0 5.25 8 13 8 13s8-7.75 8-13c0-4.42-3.58-8-8-8zm0 11c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3z"})})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),e.jsx("p",{children:"地圖暫無法顯示"}),e.jsxs("p",{className:"text-xs mt-1",children:["(",U,")"]})]})})}),e.jsxs("div",{className:"p-4 border-t border-slate-700 bg-slate-900",children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 text-sm",children:[e.jsxs("span",{className:"text-ffxiv-gold font-medium",children:["X: ",H.toFixed(1)]}),e.jsxs("span",{className:"text-ffxiv-gold font-medium",children:["Y: ",y.toFixed(1)]})]}),e.jsx("p",{className:"text-xs text-gray-400 text-center mt-2",children:"點擊外部或按 ESC 關閉"})]})]})})}let ke=null,Re=null,Me=null,Fe=null,Ce=null,_e=null,Ve=null,Pe=null,Ie=null;const kt=async()=>(ke||(ke=(await X(()=>import("./data-other-BAzrwk9S.js").then(p=>p.n),[])).default),ke),Rt=async()=>(Re||(Re=(await X(()=>import("./data-other-BAzrwk9S.js").then(p=>p.s),[])).default),Re),Mt=async()=>(Me||(Me=(await X(()=>import("./data-other-BAzrwk9S.js").then(p=>p.j),[])).default),Me),Ft=async()=>(Fe||(Fe=(await X(()=>import("./data-other-BAzrwk9S.js").then(p=>p.k),[])).default),Fe),Ct=async()=>(Ce||(Ce=(await X(()=>import("./data-zh-BCesDonN.js").then(p=>p.a),[])).default),Ce),_t=async()=>(_e||(_e=(await X(()=>import("./data-zh-BCesDonN.js").then(p=>p.b),[])).default),_e),Vt=async()=>(Ve||(Ve=(await X(()=>import("./data-zh-BCesDonN.js").then(p=>p.c),[])).default),Ve),Pt=async()=>(Pe||(Pe=(await X(()=>import("./data-db-CylQINsK.js").then(p=>p.n),[])).default),Pe),It=async()=>(Ie||(Ie=(await X(()=>import("./data-db-CylQINsK.js").then(p=>p.q),[])).default),Ie);function Jt({itemId:N,onItemClick:p,onExpandCraftingTree:U,isCraftingTreeExpanded:H=!1}){const y=bt(),[k,Z]=D.useState([]),[we,J]=D.useState(!0),[q,O]=D.useState({isOpen:!1,zoneName:"",x:0,y:0,npcName:"",mapId:null}),[se,ae]=D.useState(null),[pe,ue]=D.useState({x:0,y:0}),[le,ce]=D.useState(null),[B,De]=D.useState(null),[_,K]=D.useState(null),[de,et]=D.useState(null),[fe,tt]=D.useState(null),[he,st]=D.useState(null),[ge,nt]=D.useState(null),[Se,at]=D.useState(null),[ee,lt]=D.useState(null),[ve,rt]=D.useState(null);if(D.useEffect(()=>{N&&(J(!0),ce(null),yt(N).then(t=>{const i=t.some(a=>a.type===d.FATES);t=t.filter(a=>a.type!==d.ISLAND_PASTURE),t=t.filter(a=>a.type===d.FATES&&Array.isArray(a.data)?a.data.some(n=>{if(typeof n=="object"&&(n.nodeId!==void 0||n.itemId!==void 0)&&n.id===void 0)return!1;const l=typeof n=="object"?n.id:n;if(!l||typeof l!="number")return!1;const r=Ee[l],o=$e[l],x=Y[l]||Y[String(l)];return r||o||x}):!0);const h=ie[N]||ie[String(N)];if(h){const a=h,s=new Set;if(i){const l=t.find(r=>r.type===d.FATES);l&&Array.isArray(l.data)&&l.data.forEach(r=>{const o=typeof r=="object"?r.id:r;o&&s.add(o)})}const n=a.filter(l=>!s.has(l));if(n.length>0){const l=n.map(r=>{const o=Y[r]||Y[String(r)];return o?{id:r,level:o.lvl||o.lvlMax||0,zoneId:o.zoneid,mapId:o.map,coords:o.x!==void 0&&o.y!==void 0?{x:o.x,y:o.y}:null}:null}).filter(Boolean);if(l.length>0)if(i){const r=t.find(o=>o.type===d.FATES);r&&(r.data=[...r.data||[],...l])}else t.push({type:d.FATES,data:l})}}const g=t.some(a=>a.type===d.FATES);Object.keys(Y).forEach(a=>{const s=Y[a];if(!s)return;const n=parseInt(a,10),r=(Array.isArray(s.items)?s.items:[]).includes(N);let o=!1;if(g){const b=t.find(v=>v.type===d.FATES);b&&Array.isArray(b.data)&&(o=b.data.some(v=>(typeof v=="object"?v.id:v)===n))}const x=ie[N]||ie[String(N)],m=x&&x.includes(n);if((r||m)&&!o){const b={id:n,level:s.lvl||s.lvlMax||0,zoneId:s.zoneid,mapId:s.map,coords:s.x!==void 0&&s.y!==void 0?{x:s.x,y:s.y}:null};if(g){const v=t.find(S=>S.type===d.FATES);v?v.data=[...v.data||[],b]:t.push({type:d.FATES,data:[b]})}else t.push({type:d.FATES,data:[b]})}});const c=t.some(a=>a.type===d.QUESTS),w=[];if(Object.keys(Te).forEach(a=>{const s=Te[a];if(!s||!s.rewards)return;s.rewards.some(l=>l.id===N)&&w.push(parseInt(a,10))}),w.length>0)if(c){const a=t.find(s=>s.type===d.QUESTS);if(a&&Array.isArray(a.data)){const s=new Set(a.data.map(l=>typeof l=="object"?l.id:l)),n=w.filter(l=>!s.has(l));n.length>0&&(a.data=[...a.data,...n])}}else{const a=t.find(s=>s.type===d.MASTERBOOKS);if(a&&Array.isArray(a.data))if(a.data.every(n=>{const l=typeof n=="object"?n.id:n;return typeof l=="number"&&l>1e3&&l<1e6})){a.type=d.QUESTS;const n=new Set(a.data.map(r=>typeof r=="object"?r.id:r)),l=w.filter(r=>!n.has(r));l.length>0&&(a.data=[...a.data,...l])}else t.push({type:d.QUESTS,data:w});else t.push({type:d.QUESTS,data:w})}if(ye[N]&&Array.isArray(ye[N])&&ye[N].length>0){const a=ye[N],s=t.some(l=>l.type===d.TREASURES),n=a.filter(l=>{const r=$[l];return r&&r.tw});if(n.length>0)if(s){const l=t.find(r=>r.type===d.TREASURES);if(l&&Array.isArray(l.data)){const r=new Set(l.data.map(x=>typeof x=="object"?x.id:x)),o=n.filter(x=>!r.has(x));o.length>0&&(l.data=[...l.data,...o])}}else t.push({type:d.TREASURES,data:n})}Z(t||[]),J(!1)}).catch(t=>{console.error("Failed to load sources:",t),Z([]),J(!1)}))},[N]),D.useEffect(()=>{fe||Ft().then(t=>tt(t))},[fe]),D.useEffect(()=>{!he&&k.some(t=>t.type===d.INSTANCES)&&Ct().then(t=>st(t))},[k,he]),D.useEffect(()=>{!ge&&k.some(t=>t.type===d.QUESTS)&&_t().then(t=>nt(t))},[k,ge]),D.useEffect(()=>{!Se&&k.some(t=>t.type===d.FATES)&&Vt().then(t=>at(t))},[k,Se]),D.useEffect(()=>{!B&&k.some(t=>t.type===d.VENDORS||t.type===d.QUESTS)&&kt().then(t=>De(t))},[k,B]),D.useEffect(()=>{!_&&k.some(t=>t.type===d.VENDORS||t.type===d.TRADE_SOURCES)&&Rt().then(t=>K(t))},[k,_]),D.useEffect(()=>{!de&&k.some(t=>t.type===d.VENDORS||t.type===d.TRADE_SOURCES)&&Mt().then(t=>et(t))},[k,de]),D.useEffect(()=>{!ee&&k.some(t=>t.type===d.VENDORS||t.type===d.QUESTS)&&Pt().then(t=>lt(t))},[k,ee]),D.useEffect(()=>{!ve&&k.some(t=>t.type===d.QUESTS)&&It().then(t=>rt(t))},[k,ve]),we)return e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-ffxiv-gold"}),e.jsx("p",{className:"mt-4 text-gray-400",children:"載入取得方式..."})]});if(k.length===0){const i=$[N]?.tw||"",h=i&&i.includes("地圖");return e.jsx("div",{className:"text-center py-4 text-gray-400 text-sm",children:h?e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{children:"暫無取得方式資料"}),e.jsxs("a",{href:"https://cycleapple.github.io/xiv-tc-treasure-finder/",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-ffxiv-gold/20 hover:bg-ffxiv-gold/30 border border-ffxiv-gold/50 hover:border-ffxiv-gold text-ffxiv-gold rounded-lg transition-all duration-200 text-sm font-medium",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),"前往藏寶圖查詢器"]})]}):e.jsx("div",{children:"暫無取得方式資料"})})}const ot=t=>({[d.CRAFTED_BY]:"製作",[d.TRADE_SOURCES]:"兌換",[d.VENDORS]:"NPC商店",[d.TREASURES]:"寶箱/容器",[d.INSTANCES]:"副本掉落",[d.DESYNTHS]:"精製獲得",[d.QUESTS]:"任務獎勵",[d.FATES]:"危命任務",[d.GATHERED_BY]:"採集獲得",[d.REDUCED_FROM]:"分解獲得",[d.VENTURES]:"遠征獲得",[d.GARDENING]:"園藝獲得",[d.MOGSTATION]:"商城購買",[d.ISLAND_CROP]:"島嶼作物",[d.VOYAGES]:"遠征",[d.REQUIREMENTS]:"需求",[d.MASTERBOOKS]:"製作書",[d.ALARMS]:"鬧鐘提醒",[d.ACHIEVEMENTS]:"成就獎勵"})[t]||"未知",Ne=t=>St[t]?.tw||`NPC ${t}`,it=t=>{const i=Xe[t]||Xe[String(t)];if(i?.tw)return i.tw;if(ee){const h=ee[t]||ee[String(t)];if(h?.title?.zh)return h.title.zh}return null},re=t=>{const i=At[t];return i?.tw?i.tw:$t[t]?.en||`Zone ${t}`},ct=t=>{const i=We[t];return i?.tw?i.tw:null},ze=t=>{if(!t)return null;if(t.tw)return t.tw;if(t.zh)return t.zh;if(t.en&&fe){for(const[i,h]of Object.entries(fe))if(h?.en===t.en){const g=We[i];if(g?.tw)return g.tw}}return null},dt=t=>{if(!t)return"貨幣";const i=$[t];return i?.tw?i.tw:null},je=t=>{if(!t)return null;const i=t.toString(),h=wt[i],g=Dt[i],c=Lt[i];return h?.tw?{id:t,name:h.tw,description:g?.tw||null,icon:c?.icon?`https://xivapi.com${c.icon}`:null,itemReward:c?.itemReward||null,title:c?.title||null,nameEn:c?.en||null,nameJa:c?.ja||null}:null},Be=(t,i)=>{const h=t.currentTarget.getBoundingClientRect();ue({x:h.left+h.width/2,y:h.top}),ae(i)},Oe=t=>{if(se){const i=t.currentTarget.getBoundingClientRect();ue({x:i.left+i.width/2,y:i.top})}},Qe=()=>{ae(null)},xe=[];k.forEach(t=>{(t.type===d.ACHIEVEMENTS||t.type===19)&&Array.isArray(t.data)&&xe.push(...t.data)});const xt=t=>{const i=Et[t];if(i?.tw)return i.tw;const h=Je[t];return h?.en?h.en:`副本 ${t}`},mt=t=>he&&he[t]?.zh||null,Ue=t=>ge&&ge[t]?.zh||null,qe=t=>t&&t.replace(/[\uE000-\uF8FF\u200B-\u200D\uFEFF]/g,"").trim(),pt=(t,i,h)=>{if(!t)return null;if(h&&h.requiredQuest)return h.requiredQuest;if(_){const g=Array.isArray(_)?_.find(c=>c.id===t):_[t];if(g&&g.requiredQuest)return g.requiredQuest}if(i&&de&&de[i]){const g=de[i],c=Array.isArray(g)?g.find(w=>w.id===t):g[t];if(c&&c.requiredQuest)return c.requiredQuest}return null},Ae=t=>t.toLocaleString("zh-TW"),ut=t=>({8:"CRP",9:"BSM",10:"ARM",11:"GSM",12:"LTW",13:"WVR",14:"ALC",15:"CUL"})[t],ft=t=>Le[t]?.tw||`職業 ${t}`,ht=t=>{const i=ut(t);return i?`https://garlandtools.org/files/icons/job/${i}.png`:null},gt=t=>{if(!t)return null;const i=typeof t=="string"?parseInt(t,10):t;return $[i]?.tw||null},vt=(t,i,h=!0)=>{const{type:g,data:c}=t,w=h?"flex-1":"";if(g===d.CRAFTED_BY)return!c||c.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${w} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/000000/000501.png",alt:"Craft",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"製作"}),U&&e.jsxs("button",{onClick:a=>{a.preventDefault(),a.stopPropagation(),U()},className:`ml-auto px-2 py-1 text-xs border rounded transition-all duration-200 flex items-center gap-1 ${H?"bg-amber-900/50 hover:bg-amber-800/70 border-ffxiv-gold/60 hover:border-ffxiv-gold text-ffxiv-gold":"bg-purple-900/50 hover:bg-purple-800/70 border-purple-500/40 hover:border-purple-400/60 text-purple-200 hover:text-ffxiv-gold"}`,title:H?"收起製作價格樹":"展開製作價格樹",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),H?"收起樹":"展開樹"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:c.map((a,s)=>{const n=a.job,l=ft(n),r=ht(n),o=a.lvl||a.rlvl||0,x=a.stars_tooltip||"";return!l||l===`職業 ${n}`?null:e.jsx("button",{onClick:m=>{m.preventDefault(),m.stopPropagation(),U&&U()},className:`w-[280px] flex-grow-0 rounded p-2 min-h-[70px] flex flex-col justify-center transition-all duration-200 cursor-pointer ${H?"bg-amber-900/30 hover:bg-amber-800/40 border border-ffxiv-gold/40":"bg-slate-900/50 hover:bg-slate-800/70"}`,title:H?"點擊收起製作價格樹":"點擊展開製作價格樹",children:e.jsxs("div",{className:"flex items-center gap-2",children:[r&&e.jsx("img",{src:r,alt:l,className:"w-7 h-7 object-contain"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-white",children:l}),o>0&&e.jsxs("span",{className:"text-xs text-gray-400",children:["Lv.",o]}),x&&e.jsx("span",{className:"text-xs text-yellow-400",children:x})]}),a.masterbook&&(()=>{const m=a.masterbook.id?typeof a.masterbook.id=="string"?parseInt(a.masterbook.id,10):a.masterbook.id:null,b=(m?gt(m):a.masterbook.name?.tw||a.masterbook.name?.en)||"專用配方書";return e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["專用配方書:"," ",m?e.jsx("button",{onClick:v=>{v.preventDefault(),v.stopPropagation(),p?z(m).then(S=>{S?p(S):y(`/item/${m}`)}):y(`/item/${m}`)},className:"text-ffxiv-gold hover:text-yellow-400 hover:underline transition-colors",children:b}):e.jsx("span",{children:b})]})})()]})]})},`craft-${i}-${s}`)}).filter(Boolean)})]},`crafted-${i}`);if(g===d.TRADE_SOURCES){if(!c||c.length===0)return null;const a=[];return c.forEach((s,n)=>{const r=s.trades?.[0]?.currencies?.[0],o=r?.id,x=r?.amount,m=r?.hq===!0,u=s.id;let b=dt(o);if(!b&&o)return;const v=o?$[o]:null,S=v&&v.tw;let T=null;if(s.shopName)T=s.shopName.tw||s.shopName.zh||null;else if(s.id){const A=ct(s.id);A&&(T=A)}const j=s.npcs?.filter(A=>{const C=typeof A=="object"?A.id:A,M=Ne(C);return M&&M!==`NPC ${C}`})||[];j.length===0||!b||j.forEach(A=>{a.push({npc:A,currencyItemId:o,currencyName:b,currencyAmount:x,requiresHQ:m,hasCurrencyItem:S,shopName:T,shopId:u,tradeSource:s})})}),a.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${w} min-w-[280px]`,children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"兌換"})}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:a.map((s,n)=>{const l=s.npc,r=typeof l=="object"?l.id:l,o=Ne(r),x=typeof l=="object"?l.zoneId:null,m=typeof l=="object"?l.coords:null,u=typeof l=="object"?l.mapId:null,b=x?re(x):"",v=m&&m.x!==void 0&&m.y!==void 0,S=pt(s.shopId,r,s.tradeSource),T=S?be[S]?.tw||be[S]?.en:null;return e.jsxs("div",{className:"w-[280px] flex-grow-0 bg-slate-900/50 rounded p-2 min-h-[70px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.hasCurrencyItem?e.jsxs("button",{onClick:j=>{j.preventDefault(),j.stopPropagation(),p?z(s.currencyItemId).then(A=>{A?p(A):y(`/item/${s.currencyItemId}`)}):y(`/item/${s.currencyItemId}`)},className:"flex items-center gap-1.5 font-medium text-blue-400 hover:text-ffxiv-gold transition-colors",children:[e.jsx(Q,{itemId:s.currencyItemId,alt:s.currencyName,className:"w-7 h-7 object-contain"}),e.jsx("span",{className:"hover:underline",children:s.currencyName}),s.requiresHQ&&e.jsx("span",{className:"inline-flex items-center justify-center px-1.5 py-0.5 bg-yellow-500/20 border border-yellow-500/50 rounded text-[10px] font-bold text-yellow-400",title:"需要高品質版本",children:"HQ"})]}):e.jsxs("span",{className:"font-medium text-white flex items-center gap-1.5",children:[s.currencyName,s.requiresHQ&&e.jsx("span",{className:"inline-flex items-center justify-center px-1.5 py-0.5 bg-yellow-500/20 border border-yellow-500/50 rounded text-[10px] font-bold text-yellow-400",title:"需要高品質版本",children:"HQ"})]}),e.jsxs("span",{className:"text-yellow-400 text-sm",children:["x",s.currencyAmount]})]}),e.jsx("div",{className:"text-sm text-gray-300",children:o}),s.shopName&&e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:s.shopName}),S&&T&&e.jsxs("div",{className:"text-xs text-pink-400/90 mt-1 flex items-center gap-1",children:[e.jsx("span",{children:"需要完成任務："}),e.jsx("button",{onClick:j=>{j.preventDefault(),j.stopPropagation();const A=Ue(S);A&&window.open(`https://ff14.huijiwiki.com/wiki/任务:${encodeURIComponent(A)}`,"_blank")},className:"text-yellow-400/90 hover:text-yellow-300 hover:underline transition-colors",children:T})]}),b&&v&&e.jsxs("button",{onClick:j=>{j.preventDefault(),j.stopPropagation(),O({isOpen:!0,zoneName:b,x:m.x,y:m.y,npcName:o,mapId:u})},className:"flex items-center gap-1.5 mt-2 pt-2 border-t border-slate-700/50 text-xs text-blue-400 hover:bg-slate-800/50 hover:text-blue-300 rounded px-1 py-0.5 transition-all w-full text-left",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),e.jsxs("span",{children:[b,e.jsxs("span",{className:"ml-2",children:["X: ",m.x.toFixed(1)," - Y: ",m.y.toFixed(1)]})]})]})]},`npc-${n}`)})})]},`trade-${i}`)}if(g===d.VENDORS){const a={};c.forEach(n=>{const l=n.npcId;a[l]||(a[l]=[]),a[l].push(n)});const s=Object.keys(a).map(n=>({npcId:n,vendors:a[n]}));return e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${w} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/065000/065002.png",alt:"Gil",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"NPC商店"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:s.map((n,l)=>{const r=n.vendors,o=r[0],x=Ne(o.npcId);let m=o.zoneId,u=o.coords,b=o.mapId;if((!m||!u||u.x===void 0||u.y===void 0)&&o.npcId&&B){const E=B[o.npcId]||B[String(o.npcId)];E?.position&&(m=m||E.position.zoneid,b=b||E.position.map,(!u||u.x===void 0||u.y===void 0)&&(u={x:E.position.x,y:E.position.y}))}!m&&!u&&(x?.includes("古董商")||x?.includes("journeyman salvager")||o.npcId>=1025e3&&o.npcId<1026e3)&&(m=1160,u={x:0,y:0},b=null),m&&(!u||u.x===void 0||u.y===void 0)&&(u={x:0,y:0});const S=m?re(m):"",T=S&&u&&u.x!==void 0&&u.y!==void 0,j=T&&b&&(u.x!==0||u.y!==0),A=r.map(E=>ze(E.shopName)).filter(Boolean),C=[...new Set(A)],M=xe.length>0||r.some(E=>{const W=ze(E.shopName);return E.shopName&&(E.shopName.en?.toLowerCase().includes("achievement")||E.shopName.en?.toLowerCase().includes("reward")||W?.includes("成就"))}),f=r.map(E=>E.price).filter(Boolean),F=f.length>0?Math.min(...f):null,P=f.length>0?Math.max(...f):null,G=F!==null&&P!==null&&F!==P;return e.jsxs("div",{className:"w-[280px] flex-grow-0 bg-slate-900/50 rounded p-2 min-h-[70px] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-white",children:x}),(()=>{const E=it(o.npcId);return E?e.jsxs("span",{className:"text-xs text-gray-400",children:["<",E,">"]}):null})()]}),F&&e.jsxs("span",{className:"text-yellow-400 text-sm",children:[G?`${Ae(F)} - ${Ae(P)}`:Ae(F)," Gil"]})]}),C.length>0&&e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:C.join(", ")}),M&&xe.length>0&&(()=>{const E=je(xe[0]);return E?e.jsxs("div",{className:"text-xs mt-1 flex items-start gap-1 relative",onMouseEnter:W=>Be(W,xe[0]),onMouseMove:Oe,onMouseLeave:Qe,children:[e.jsx("span",{className:"text-pink-400/90",children:"需要完成成就："}),e.jsx("span",{className:"font-medium text-yellow-400/90 cursor-help underline decoration-dotted decoration-yellow-400/50 hover:decoration-yellow-400 transition-colors",children:E.name})]}):null})(),T&&(j?e.jsxs("button",{onClick:()=>O({isOpen:!0,zoneName:S,x:u.x,y:u.y,npcName:x,mapId:b}),className:"flex items-center gap-1.5 mt-1 pt-1 border-t border-slate-700/50 text-xs text-blue-400 hover:bg-slate-800/50 hover:text-blue-300 rounded px-1 py-0.5 transition-all w-full text-left",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),e.jsxs("span",{children:[S,e.jsxs("span",{className:"ml-2",children:["X: ",u.x.toFixed(1)," - Y: ",u.y.toFixed(1)]})]})]}):e.jsxs("div",{className:"flex items-center gap-1.5 mt-1 pt-1 border-t border-slate-700/50 text-xs text-blue-400",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),e.jsxs("span",{children:[S,e.jsxs("span",{className:"ml-2",children:["X: ",u.x.toFixed(1)," - Y: ",u.y.toFixed(1)]})]})]}))]},l)})})]},`vendor-${i}`)}if(g===d.TREASURES)return e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${w} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/061000/061808.png",alt:"Treasure",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"寶箱/容器"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:c.map((a,s)=>{const n=$[a];if(!n||!n.tw)return null;const l=n.tw;return e.jsxs("button",{onClick:r=>{r.preventDefault(),r.stopPropagation(),p?z(a).then(o=>{o?p(o):y(`/item/${a}`)}):y(`/item/${a}`)},className:"w-[280px] flex-grow-0 flex items-center justify-start gap-2 text-left text-sm text-blue-400 hover:text-ffxiv-gold transition-colors bg-slate-900/50 rounded p-2 hover:bg-slate-800/70 min-h-[70px]",children:[e.jsx(Q,{itemId:a,alt:l,className:"w-7 h-7 object-contain"}),e.jsx("span",{className:"hover:underline",children:l})]},s)}).filter(Boolean)})]},`treasure-${i}`);if(g===d.INSTANCES)return e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${w} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/061000/061801.png",alt:"Instance",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"副本掉落"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:c.map((a,s)=>{const n=xt(a);if(n===`副本 ${a}`)return null;const l=mt(a),r=Je[a];let x=r?.icon?`https://xivapi.com${r.icon}`:"https://xivapi.com/i/061000/061801.png";return r?.contentType&&(r.contentType===4?x="https://xivapi.com/i/061000/061804.png":r.contentType===5?x="https://xivapi.com/i/061000/061802.png":r.contentType===28?x="https://xivapi.com/i/061000/061832.png":r.contentType===21&&(x="https://xivapi.com/i/061000/061824.png")),e.jsx("div",{className:"w-[280px] flex-grow-0 bg-slate-900/50 rounded p-2 min-h-[70px] flex flex-col justify-center",children:l?e.jsxs("a",{href:`https://ff14.huijiwiki.com/wiki/${encodeURIComponent(l)}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 group",onClick:m=>m.stopPropagation(),children:[e.jsx("img",{src:x,alt:"Instance",className:"w-7 h-7"}),e.jsx("span",{className:"text-sm text-blue-400 group-hover:text-ffxiv-gold transition-colors flex items-center gap-1",children:n})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:x,alt:"Instance",className:"w-7 h-7"}),e.jsx("span",{className:"text-sm text-gray-300",children:n})]})},s)}).filter(Boolean)})]},`instance-${i}`);if(g===d.DESYNTHS){const a=c.filter(s=>{const n=$[s];return n&&n.tw});return a.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${w} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/000000/000120.png",alt:"Desynth",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"精製獲得"})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:a.map((s,n)=>{const r=$[s]?.tw;return r?e.jsxs("button",{onClick:o=>{o.preventDefault(),o.stopPropagation(),p?z(s).then(x=>{x?p(x):y(`/item/${s}`)}):y(`/item/${s}`)},className:"flex flex-col items-center gap-1.5 p-2 rounded-lg bg-slate-900/50 border border-slate-700/50 hover:border-ffxiv-gold/60 hover:bg-slate-800/70 transition-all duration-200 group",children:[e.jsx(Q,{itemId:s,alt:r,className:"w-10 h-10 object-contain rounded border border-slate-700/50 group-hover:border-ffxiv-gold/60 transition-colors duration-200"}),e.jsx("span",{className:"text-xs text-blue-400 group-hover:text-ffxiv-gold text-center line-clamp-2 transition-colors duration-200",title:r,children:r})]},n):null})})]},`desynth-${i}`)}if(g===d.QUESTS){const a=c.filter(s=>{const n=be[s];return n&&n.tw});return a.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${w} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/060000/060453.png",alt:"Quest",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"任務獎勵"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:a.map((s,n)=>{const r=be[s]?.tw,o=qe(r);if(!o)return null;const x=Te[s],m=x?.icon?`https://xivapi.com${x.icon}`:"https://xivapi.com/i/060000/060453.png",u=Ue(s),b=qe(u),v=ve?ve[s]:null,S=v?.level||null,T=v?.jobCategory||null,j=v?.start||null,A=j?Ne(j):null;let C="";T===1?C="所有職業":T&&Le[T]&&(C=Le[T].tw||"");let M=null,f=null,F=null;const P=v?.startingPoint||null;if(P&&(M=P.zoneid||null,F=P.map||null,P.x!==void 0&&P.y!==void 0&&(f={x:P.x,y:P.y})),(!M||!f||f.x===void 0||f.y===void 0)&&j&&B){const R=B[j]||B[String(j)];R?.position&&(M=M||R.position.zoneid,F=F||R.position.map,(!f||f.x===void 0||f.y===void 0)&&(f={x:R.position.x,y:R.position.y}))}if((!M||!f||f.x===void 0||f.y===void 0)&&j&&ee){const R=ee[j]||ee[String(j)];R?.position&&(M=M||R.position.zoneid,F=F||R.position.map,(!f||f.x===void 0||f.y===void 0)&&(f={x:R.position.x,y:R.position.y}))}if((!M||!f||f.x===void 0||f.y===void 0)&&v?.npcs&&B)for(const R of v.npcs){const ne=B[R]||B[String(R)];if(ne?.position){M=M||ne.position.zoneid,F=F||ne.position.map,(!f||f.x===void 0||f.y===void 0)&&(f={x:ne.position.x,y:ne.position.y});break}}const G=M?re(M):"",E=G&&f&&f.x!==void 0&&f.y!==void 0,W=E&&F&&(f.x!==0||f.y!==0);return e.jsxs("div",{className:"w-[280px] flex-grow-0 bg-slate-900/50 rounded p-2 min-h-[70px] flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("img",{src:m,alt:"Quest",className:"w-7 h-7 object-contain flex-shrink-0"}),e.jsx("div",{className:"flex-1 min-w-0",children:b?e.jsx("a",{href:`https://ff14.huijiwiki.com/wiki/任务:${encodeURIComponent(b)}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium text-blue-400 hover:text-ffxiv-gold hover:underline transition-colors cursor-pointer",onClick:R=>R.stopPropagation(),children:o}):e.jsx("span",{className:"text-sm font-medium text-gray-300",children:o})})]}),e.jsxs("div",{className:"space-y-1 mt-1 text-xs text-gray-400",children:[(S||C)&&e.jsxs("div",{className:"flex items-center gap-2",children:[C&&e.jsx("span",{children:C}),S&&e.jsxs("span",{children:[S,"級"]})]}),A&&A!==`NPC ${j}`&&e.jsx("div",{className:"text-gray-400",children:A}),E&&G&&(W?e.jsxs("button",{onClick:R=>{R.preventDefault(),R.stopPropagation(),O({isOpen:!0,zoneName:G,x:f.x,y:f.y,npcName:A||o,mapId:F})},className:"flex items-center gap-1.5 mt-1 pt-1 border-t border-slate-700/50 text-xs text-blue-400 hover:bg-slate-800/50 hover:text-blue-300 rounded px-1 py-0.5 transition-all w-full text-left",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),e.jsxs("span",{children:[G,e.jsxs("span",{className:"ml-2",children:["X: ",f.x.toFixed(1)," - Y: ",f.y.toFixed(1)]})]})]}):e.jsxs("div",{className:"mt-1 pt-1 border-t border-slate-700/50 text-xs text-gray-400",children:[G,f&&f.x!==void 0&&f.y!==void 0&&e.jsxs("span",{className:"ml-2",children:["X: ",f.x.toFixed(1)," - Y: ",f.y.toFixed(1)]})]}))]})]},n)}).filter(Boolean)})]},`quest-${i}`)}if(g===d.FATES){const a=c.filter(s=>{if(typeof s=="object"&&(s.nodeId!==void 0||s.itemId!==void 0)&&s.id===void 0)return!1;const n=typeof s=="object"?s.id:s;if(!n||typeof n!="number")return!1;const l=Ee[n],r=$e[n],o=Y[n]||Y[String(n)];return l||r||o});return a.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${w} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/060000/060502.png",alt:"FATE",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"危命任務"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:a.map((s,n)=>{const l=typeof s=="object"?s.id:s,r=typeof s=="object"?s.level:null,o=typeof s=="object"?s.zoneId:null,x=typeof s=="object"?s.mapId:null,m=typeof s=="object"?s.coords:null,u=Ee[l],b=Se?.[l],v=u?.name?.tw||`FATE ${l}`,S=b?.name?.zh||v,T=$e[l],j=T?.icon?`https://xivapi.com${T.icon}`:"https://xivapi.com/i/060000/060502.png",A=o?re(o):"",C=m&&m.x!==void 0&&m.y!==void 0&&x,f=(Y[l]||Y[String(l)])?.items||[],F=f.includes(N),P=ie[N]||ie[String(N)],G=P&&P.includes(l),E=f,W=!F&&G?[N]:[],R=r&&r>=32&&j.includes("060958"),ne=`https://ff14.huijiwiki.com/wiki/${encodeURIComponent(S)}`;return e.jsxs("div",{className:"w-[280px] flex-grow-0 bg-slate-900/50 rounded p-2 min-h-[70px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("img",{src:j,alt:"FATE",className:"w-7 h-7 object-contain"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("a",{href:ne,target:"_blank",rel:"noopener noreferrer",onClick:L=>{L.stopPropagation()},className:"text-sm font-medium text-blue-400 hover:text-ffxiv-gold hover:underline transition-colors cursor-pointer",children:v}),r&&e.jsxs("div",{className:"text-xs text-gray-400 mt-0.5",children:[A?`${A} `:"",r,"級危命任務",R&&e.jsx("span",{className:"ml-1 text-yellow-400",children:"惡名精英"})]})]})]}),(E.length>0||W.length>0)&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-slate-700/50 w-full",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2 font-medium",children:"獎勵物品"}),e.jsx("div",{className:"w-full border border-slate-700/50 rounded-lg overflow-hidden bg-slate-900/30",children:e.jsxs("table",{className:"w-full text-xs border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-800/50 border-b border-slate-700/50",children:[e.jsx("th",{className:"text-left text-gray-400 font-normal py-2 px-3 w-20",children:"評價"}),e.jsx("th",{className:"text-left text-gray-400 font-normal py-2 px-3",children:"獎勵物品"})]})}),e.jsxs("tbody",{children:[E.length>0&&e.jsxs("tr",{className:"border-b border-slate-700/30 bg-slate-900/30",children:[e.jsx("td",{className:"py-2.5 px-3 text-gray-300 align-top font-medium whitespace-nowrap",children:"銀牌"}),e.jsx("td",{className:"py-2.5 px-3 w-auto",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:E.map(L=>{const I=$[L];return!I||!I.tw?null:e.jsxs("button",{onClick:oe=>{oe.preventDefault(),oe.stopPropagation(),p?z(L).then(te=>{te?p(te):y(`/item/${L}`)}):y(`/item/${L}`)},className:"flex items-center gap-1.5 text-blue-400 hover:text-ffxiv-gold transition-colors",children:[e.jsx(Q,{itemId:L,alt:I.tw,className:"w-5 h-5 object-contain"}),e.jsx("span",{className:"hover:underline",children:I.tw})]},`silver-${L}`)}).filter(Boolean)})})]}),E.length>0&&e.jsxs("tr",{className:"bg-slate-900/30",children:[e.jsx("td",{className:"py-2.5 px-3 text-gray-300 align-top font-medium whitespace-nowrap",children:"金牌"}),e.jsx("td",{className:"py-2.5 px-3 w-auto",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:E.map(L=>{const I=$[L];return!I||!I.tw?null:e.jsxs("button",{onClick:te=>{te.preventDefault(),te.stopPropagation(),p?z(L).then(Ge=>{Ge?p(Ge):y(`/item/${L}`)}):y(`/item/${L}`)},className:"flex items-center gap-1.5 text-blue-400 hover:text-ffxiv-gold transition-colors",children:[e.jsx(Q,{itemId:L,alt:I.tw,className:"w-5 h-5 object-contain"}),e.jsxs("span",{className:"hover:underline",children:[I.tw," ×5"]})]},`gold-${L}`)}).filter(Boolean)})})]}),W.length>0&&e.jsxs("tr",{className:"bg-slate-900/30",children:[e.jsx("td",{className:"py-2.5 px-3 text-gray-300 align-top font-medium whitespace-nowrap",children:"稀有"}),e.jsx("td",{className:"py-2.5 px-3 w-auto",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:W.map(L=>{const I=$[L];return!I||!I.tw?null:e.jsxs("button",{onClick:oe=>{oe.preventDefault(),oe.stopPropagation(),p?z(L).then(te=>{te?p(te):y(`/item/${L}`)}):y(`/item/${L}`)},className:"flex items-center gap-1.5 text-blue-400 hover:text-ffxiv-gold transition-colors",children:[e.jsx(Q,{itemId:L,alt:I.tw,className:"w-5 h-5 object-contain"}),e.jsx("span",{className:"hover:underline",children:I.tw})]},`rare-${L}`)}).filter(Boolean)})})]})]})]})})]}),C&&e.jsxs("button",{onClick:L=>{L.preventDefault(),L.stopPropagation(),O({isOpen:!0,zoneName:A,x:m.x,y:m.y,npcName:v,mapId:x})},className:"flex items-center gap-1.5 mt-2 pt-2 border-t border-slate-700/50 text-xs text-blue-400 hover:bg-slate-800/50 hover:text-blue-300 rounded px-1 py-0.5 transition-all w-full text-left",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),e.jsxs("span",{children:[A,e.jsxs("span",{className:"ml-2",children:["X: ",m.x.toFixed(1)," - Y: ",m.y.toFixed(1)]})]})]})]},n)}).filter(Boolean)})]},`fate-${i}`)}if(g===d.ISLAND_PASTURE)return null;if(g===d.GATHERED_BY){if(!c||!c.nodes||!Array.isArray(c.nodes)||c.nodes.length===0)return null;const a={0:"https://xivapi.com/i/060000/060438.png",1:"https://xivapi.com/i/060000/060437.png",2:"https://xivapi.com/i/060000/060433.png",3:"https://xivapi.com/i/060000/060432.png",4:"https://xivapi.com/i/060000/060445.png",5:"https://xivapi.com/i/060000/060465.png"},s={0:"採礦",1:"採石",2:"採伐",3:"割取",4:"釣魚",5:"潛水"},n=c.level||0,l=c.stars_tooltip||"",r=c.type!==void 0?c.type:c.nodes[0]?.type!==void 0?c.nodes[0].type:0,o=Math.abs(r),x=a[o]||a[0],m=s[o]||"採集";return e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${w} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:x,alt:m,className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"採集獲得"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsxs("div",{className:"w-full text-sm text-gray-300 mb-2",children:[e.jsx("span",{className:"text-ffxiv-gold",children:m}),n>0&&e.jsxs("span",{className:"ml-2",children:["Lv.",n]}),l&&e.jsx("span",{className:"ml-2 text-yellow-400",children:l})]}),c.nodes.map((u,b)=>{const v=u.zoneId,S=v?re(v):"",T=u.map,j=u.x!==void 0&&u.y!==void 0?{x:u.x,y:u.y}:null,A=j&&T,C=u.level||n,M=u.limited===!0,f=u.isIslandNode===!0;return e.jsxs("div",{className:"w-[280px] flex-grow-0 bg-slate-900/50 rounded p-2 min-h-[70px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("img",{src:x,alt:m,className:"w-7 h-7 object-contain"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-white",children:S||`區域 ${v}`}),!f&&C>0&&e.jsxs("div",{className:"text-xs text-gray-400 mt-0.5",children:["Lv.",C," ",m,M&&e.jsx("span",{className:"ml-1 text-yellow-400",children:"限時"})]}),f&&e.jsx("div",{className:"text-xs text-gray-400 mt-0.5",children:"島嶼採集點"})]})]}),A&&e.jsxs("button",{onClick:F=>{F.preventDefault(),F.stopPropagation(),O({isOpen:!0,zoneName:S,x:j.x,y:j.y,npcName:`${m}採集點`,mapId:T})},className:"flex items-center gap-1.5 mt-2 pt-2 border-t border-slate-700/50 text-xs text-blue-400 hover:bg-slate-800/50 hover:text-blue-300 rounded px-1 py-0.5 transition-all w-full text-left",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),e.jsxs("span",{children:[S,e.jsxs("span",{className:"ml-2",children:["X: ",j.x.toFixed(1)," - Y: ",j.y.toFixed(1)]})]})]})]},b)})]})]},`gathered-${i}`)}if(g===d.REDUCED_FROM){if(!c||!Array.isArray(c)||c.length===0)return null;const a=c.filter(s=>{const n=$[s];return n&&n.tw});return a.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${w} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/061000/061808.png",alt:"Reduction",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"分解獲得"})]}),e.jsx("div",{className:a.length===1?"flex justify-center gap-2 mt-2":"grid grid-cols-3 gap-2 mt-2",children:a.map((s,n)=>{const r=$[s]?.tw;return r?e.jsxs("button",{onClick:o=>{o.preventDefault(),o.stopPropagation(),p?z(s).then(x=>{x?p(x):y(`/item/${s}`)}):y(`/item/${s}`)},className:"flex flex-col items-center gap-1.5 p-2 rounded-lg bg-slate-900/50 border border-slate-700/50 hover:border-ffxiv-gold/60 hover:bg-slate-800/70 transition-all duration-200 group",children:[e.jsx(Q,{itemId:s,alt:r,className:"w-10 h-10 object-contain rounded border border-slate-700/50 group-hover:border-ffxiv-gold/60 transition-colors duration-200"}),e.jsx("span",{className:"text-xs text-blue-400 group-hover:text-ffxiv-gold text-center line-clamp-2 transition-colors duration-200",title:r,children:r})]},n):null})})]},`reduced-${i}`)}if(g===d.VENTURES){if(!c||!Array.isArray(c)||c.length===0)return null;const a=c.filter(s=>{const n=$[s];return n&&n.tw});return a.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${w} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/021000/021267.png",alt:"Venture",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"遠征獲得"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:a.map((s,n)=>{const r=$[s]?.tw;return r?e.jsxs("button",{onClick:o=>{o.preventDefault(),o.stopPropagation(),p?z(s).then(x=>{x?p(x):y(`/item/${s}`)}):y(`/item/${s}`)},className:"w-[280px] flex-grow-0 flex items-center justify-start gap-2 text-left text-sm text-blue-400 hover:text-ffxiv-gold transition-colors bg-slate-900/50 rounded p-2 hover:bg-slate-800/70 min-h-[70px]",children:[e.jsx(Q,{itemId:s,alt:r,className:"w-7 h-7 object-contain"}),e.jsx("span",{className:"hover:underline",children:r})]},n):null}).filter(Boolean)})]},`venture-${i}`)}if(g===d.GARDENING){if(!c||!Array.isArray(c)||c.length===0)return null;const a=c.filter(s=>{const n=typeof s=="object"?s.id:s,l=$[n];return l&&l.tw});return a.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${w} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/061000/061808.png",alt:"Gardening",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"園藝獲得"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:a.map((s,n)=>{const l=typeof s=="object"?s.id:s,o=$[l]?.tw;return o?e.jsxs("button",{onClick:x=>{x.preventDefault(),x.stopPropagation(),p?z(l).then(m=>{m?p(m):y(`/item/${l}`)}):y(`/item/${l}`)},className:"w-[280px] flex-grow-0 flex items-center justify-start gap-2 text-left text-sm text-blue-400 hover:text-ffxiv-gold transition-colors bg-slate-900/50 rounded p-2 hover:bg-slate-800/70 min-h-[70px]",children:[e.jsx(Q,{itemId:l,alt:o,className:"w-7 h-7 object-contain"}),e.jsx("span",{className:"hover:underline",children:o})]},n):null}).filter(Boolean)})]},`gardening-${i}`)}if(g===d.MOGSTATION)return!c||!Array.isArray(c)||c.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${w} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/065000/065002.png",alt:"Mogstation",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"商城購買"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:e.jsx("div",{className:"w-[280px] flex-grow-0 bg-slate-900/50 rounded p-2 min-h-[70px] flex flex-col justify-center",children:e.jsx("div",{className:"text-sm text-gray-300 text-center",children:"可在 Mog Station 商城購買"})})})]},`mogstation-${i}`);if(g===d.ISLAND_CROP){if(!c||!Array.isArray(c)||c.length===0)return null;const a=c.filter(s=>{const n=$[s];return n&&n.tw});return a.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${w} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/063000/063950_hr1.png",alt:"Island Crop",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"島嶼作物"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:a.map((s,n)=>{const r=$[s]?.tw;return r?e.jsxs("button",{onClick:o=>{o.preventDefault(),o.stopPropagation(),p?z(s).then(x=>{x?p(x):y(`/item/${s}`)}):y(`/item/${s}`)},className:"w-[280px] flex-grow-0 flex items-center justify-start gap-2 text-left text-sm text-blue-400 hover:text-ffxiv-gold transition-colors bg-slate-900/50 rounded p-2 hover:bg-slate-800/70 min-h-[70px]",children:[e.jsx(Q,{itemId:s,alt:r,className:"w-7 h-7 object-contain"}),e.jsx("span",{className:"hover:underline",children:r})]},n):null}).filter(Boolean)})]},`island-crop-${i}`)}if(g===d.VOYAGES)return!c||!Array.isArray(c)||c.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${w} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/021000/021267.png",alt:"Voyage",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"遠征"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:e.jsx("div",{className:"w-[280px] flex-grow-0 bg-slate-900/50 rounded p-2 min-h-[70px] flex flex-col justify-center",children:e.jsx("div",{className:"text-sm text-gray-300 text-center",children:"可通過遠征獲得"})})})]},`voyage-${i}`);if(g===d.REQUIREMENTS){if(!c||!Array.isArray(c)||c.length===0)return null;const a=c.filter(s=>{if(typeof s=="number"){const n=$[s];return n&&n.tw}return!1});return a.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${w} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/060000/060453.png",alt:"Requirement",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"需求"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:a.map((s,n)=>{const r=$[s]?.tw;return r?e.jsxs("button",{onClick:o=>{o.preventDefault(),o.stopPropagation(),p?z(s).then(x=>{x?p(x):y(`/item/${s}`)}):y(`/item/${s}`)},className:"w-[280px] flex-grow-0 flex items-center justify-start gap-2 text-left text-sm text-blue-400 hover:text-ffxiv-gold transition-colors bg-slate-900/50 rounded p-2 hover:bg-slate-800/70 min-h-[70px]",children:[e.jsx(Q,{itemId:s,alt:r,className:"w-7 h-7 object-contain"}),e.jsx("span",{className:"hover:underline",children:r})]},n):null}).filter(Boolean)})]},`requirement-${i}`)}if(g===d.MASTERBOOKS){if(!c||!Array.isArray(c)||c.length===0)return null;const a=c.filter(s=>{const n=$[s];return n&&n.tw});return a.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${w} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/065000/065002.png",alt:"Masterbook",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"製作書"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:a.map((s,n)=>{const r=$[s]?.tw;return r?e.jsxs("button",{onClick:o=>{o.preventDefault(),o.stopPropagation(),p?z(s).then(x=>{x?p(x):y(`/item/${s}`)}):y(`/item/${s}`)},className:"w-[280px] flex-grow-0 flex items-center justify-start gap-2 text-left text-sm text-blue-400 hover:text-ffxiv-gold transition-colors bg-slate-900/50 rounded p-2 hover:bg-slate-800/70 min-h-[70px]",children:[e.jsx(Q,{itemId:s,alt:r,className:"w-7 h-7 object-contain"}),e.jsx("span",{className:"hover:underline",children:r})]},n):null}).filter(Boolean)})]},`masterbook-${i}`)}if(g===d.ALARMS){if(!c||!Array.isArray(c)||c.length===0)return null;const a={0:"https://xivapi.com/i/060000/060438.png",1:"https://xivapi.com/i/060000/060437.png",2:"https://xivapi.com/i/060000/060433.png",3:"https://xivapi.com/i/060000/060432.png",4:"https://xivapi.com/i/060000/060445.png",5:"https://xivapi.com/i/060000/060465.png"},s={0:"採礦",1:"採石",2:"採伐",3:"割取",4:"釣魚",5:"潛水"};return e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${w} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/060000/060502.png",alt:"Alarm",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"鬧鐘提醒"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:c.map((n,l)=>{if(!n||typeof n!="object")return null;const r=n.zoneId,o=r?re(r):"",x=n.mapId,m=n.coords,u=n.type!==void 0?Math.abs(n.type):0,b=a[u]||a[0],v=s[u]||"採集",S=n.duration||0,T=n.spawns||[],j=n.ephemeral===!0,A=m&&m.x!==void 0&&m.y!==void 0&&x;return e.jsxs("div",{className:"bg-slate-900/50 rounded p-2 min-h-[70px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("img",{src:b,alt:v,className:"w-7 h-7 object-contain"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-white",children:o||`區域 ${r}`}),e.jsxs("div",{className:"text-xs text-gray-400 mt-0.5",children:[v,S>0&&e.jsxs("span",{className:"ml-1",children:["持續 ",S," 分鐘"]}),j&&e.jsx("span",{className:"ml-1 text-yellow-400",children:"限時"}),T.length>0&&e.jsxs("span",{className:"ml-1",children:["出現時間: ",T.join(", ")]})]})]})]}),A&&e.jsxs("button",{onClick:C=>{C.preventDefault(),C.stopPropagation(),O({isOpen:!0,zoneName:o,x:m.x,y:m.y,npcName:`${v}採集點`,mapId:x})},className:"flex items-center gap-1.5 mt-2 pt-2 border-t border-slate-700/50 text-xs text-blue-400 hover:bg-slate-800/50 hover:text-blue-300 rounded px-1 py-0.5 transition-all w-full text-left",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),e.jsxs("span",{children:[o,e.jsxs("span",{className:"ml-2",children:["X: ",m.x.toFixed(1)," - Y: ",m.y.toFixed(1)]})]})]})]},l)}).filter(Boolean)})]},`alarm-${i}`)}if(g===d.ACHIEVEMENTS||g===22){if(!c||!Array.isArray(c)||c.length===0)return null;const a=c.filter(s=>{const n=je(s);return n&&n.name});return a.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${w} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/060000/060453.png",alt:"Achievement",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"成就獎勵"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:a.map((s,n)=>{const l=je(s);return l?e.jsx("div",{className:"w-[280px] flex-grow-0 bg-slate-900/50 rounded p-2 min-h-[70px] flex flex-col justify-center",onMouseEnter:r=>Be(r,s),onMouseMove:Oe,onMouseLeave:Qe,children:e.jsxs("div",{className:"flex items-center gap-2",children:[l.icon&&e.jsx("img",{src:l.icon,alt:l.name,className:"w-7 h-7 object-contain"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-yellow-400 cursor-help underline decoration-dotted decoration-yellow-400/50 hover:decoration-yellow-400 transition-colors",children:l.name}),l.description&&e.jsx("div",{className:"text-xs text-gray-400 mt-0.5 line-clamp-2",children:l.description})]})]})},n):null}).filter(Boolean)})]},`achievement-${i}`)}return null},Ye=t=>{const{type:i,data:h}=t;if(!h)return 0;if(Array.isArray(h)){if(i===d.VENDORS)return new Set(h.map(c=>c.npcId)).size;if(i===d.TRADE_SOURCES){const g=new Set;return h.forEach(c=>{c.npcs?.forEach(w=>{const a=typeof w=="object"?w.id:w;a&&g.add(a)})}),g.size}return h.length}return typeof h=="object"?i===d.GATHERED_BY&&h.nodes?h.nodes.length:i===d.ALARMS&&Array.isArray(h)?h.length:1:0},me=[...k].sort((t,i)=>{const h=Ye(t);return Ye(i)-h}),Nt=le?me.filter(t=>t.type===le):me,He=[...new Set(me.map(t=>t.type))],jt=Nt.map((t,i)=>vt(t,i,!1)).filter(Boolean),V=se?je(se):null;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4 flex-wrap",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-ffxiv-gold flex items-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"取得方式"]}),me.length>0&&e.jsxs("span",{className:"text-xs text-gray-400 bg-amber-900/40 px-2 py-1 rounded border border-ffxiv-gold/30",children:[me.length," 種"]}),He.length>0&&e.jsxs("div",{className:"flex items-center gap-1.5 ml-auto flex-wrap",children:[e.jsx("button",{onClick:()=>ce(null),className:`px-2 py-1 rounded-md text-xs font-medium transition-all border ${le===null?"border-ffxiv-gold bg-ffxiv-gold/20 text-ffxiv-gold":"border-gray-600 bg-slate-800/50 text-gray-400 hover:border-gray-500 hover:bg-slate-700/50"}`,children:"全部"}),He.map(t=>{const i=ot(t),h=le===t;return e.jsx("button",{onClick:()=>ce(h?null:t),className:`px-2 py-1 rounded-md text-xs font-medium transition-all border ${h?"border-ffxiv-gold bg-ffxiv-gold/20 text-ffxiv-gold":"border-gray-600 bg-slate-800/50 text-gray-400 hover:border-gray-500 hover:bg-slate-700/50"}`,children:i},t)})]})]}),e.jsx("div",{className:"flex flex-wrap gap-3 items-start",children:jt}),se&&V&&e.jsx("div",{className:"fixed z-[9999] bg-slate-900 border-2 border-yellow-400/60 rounded-lg shadow-2xl p-4 max-w-sm pointer-events-auto",style:{left:`${pe.x}px`,top:`${pe.y}px`,transform:"translate(-50%, calc(-100% - 10px))"},onMouseEnter:t=>{t.stopPropagation()},onMouseLeave:()=>{ae(null)},children:e.jsxs("div",{className:"flex items-start gap-3",children:[V.icon&&e.jsx("img",{src:V.icon,alt:V.name,className:"w-12 h-12 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-semibold text-yellow-400 mb-1",children:V.name}),V.description&&e.jsx("div",{className:"text-xs text-gray-300 mb-2 leading-relaxed",children:V.description}),e.jsxs("div",{className:"flex flex-col gap-1 mt-2 pt-2 border-t border-slate-700",children:[V.id&&e.jsxs("div",{className:"text-xs text-gray-400",children:[e.jsx("span",{className:"text-gray-500",children:"成就ID:"})," ",V.id]}),V.itemReward&&e.jsxs("div",{className:"text-xs text-gray-400",children:[e.jsx("span",{className:"text-gray-500",children:"獎勵物品:"}),e.jsx("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),p?z(V.itemReward).then(i=>{i?p(i):y(`/item/${V.itemReward}`)}):y(`/item/${V.itemReward}`),ae(null)},className:"ml-1 text-ffxiv-gold hover:text-yellow-400 hover:underline pointer-events-auto",children:$[V.itemReward]?.tw||`Item ${V.itemReward}`})]})]})]})]})}),e.jsx(Tt,{isOpen:q.isOpen,onClose:()=>O({...q,isOpen:!1}),zoneName:q.zoneName,x:q.x,y:q.y,npcName:q.npcName,mapId:q.mapId})]})}export{Jt as default};
